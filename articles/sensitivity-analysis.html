<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Sensitivity Analyses in Triangulate • triangulate</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sensitivity Analyses in Triangulate">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">triangulate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/absolute_direction.html">Absolute direction of bias/indirectness</a></li>
    <li><a class="dropdown-item" href="../articles/additional-levels-of-bias-and-indirectness.html">Adding additional levels of bias and indirectness</a></li>
    <li><a class="dropdown-item" href="../articles/beta-carotene-chd-example.html">Beta-carotene CHD triangulation example</a></li>
    <li><a class="dropdown-item" href="../articles/Creating-triangulation-datasets.html">Creating triangulation datasets</a></li>
    <li><a class="dropdown-item" href="../articles/interactive-sensitivity.html">Interactive Sensitivity Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/sensitivity-analysis.html">Sensitivity Analyses in Triangulate</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mcguinlu/triangulate/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Sensitivity Analyses in Triangulate</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mcguinlu/triangulate/blob/master/vignettes/articles/sensitivity-analysis.Rmd" class="external-link"><code>vignettes/articles/sensitivity-analysis.Rmd</code></a></small>
      <div class="d-none name"><code>sensitivity-analysis.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This article demonstrates how to conduct simple sensitivity analyses
using the triangulate package. We will explore how changes in bias
priors influence the resulting adjusted estimates, allowing us to assess
how sensitive bias-adjusted results are to different assumptions.</p>
<p>We use a manually-created, simplified version of the CHD dataset,
examining how different assumptions affect the pooled results.</p>
</div>
<div class="section level2">
<h2 id="create-example-dataset">Create example dataset<a class="anchor" aria-label="anchor" href="#create-example-dataset"></a>
</h2>
<p>We define a small synthetic dataset mimicking studies with moderate
bias and indirectness.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># creates 4 made up study results with effect estimates (yi) and variances (vi)</span></span>
<span></span>
<span><span class="va">example_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  result_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"S"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>  study <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Study"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>  yi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.2</span>, <span class="fl">0.25</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.15</span><span class="op">)</span>,</span>
<span>  vi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.02</span>, <span class="fl">0.03</span>, <span class="fl">0.015</span>, <span class="fl">0.025</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="define-default-bias-and-indirectness-priors">Define Default Bias and Indirectness Priors<a class="anchor" aria-label="anchor" href="#define-default-bias-and-indirectness-priors"></a>
</h2>
<p>We apply “moderate” priors for all studies, similar to a base-case
analysis.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># assumptions about additive and proportional bias, each with some uncertainty</span></span>
<span></span>
<span><span class="va">bias_priors</span> <span class="op">&lt;-</span> <span class="va">example_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    domain <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>    j <span class="op">=</span> <span class="st">"moderate"</span>,</span>
<span>    bias_m_add <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>    bias_v_add <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>    bias_m_prop <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>    bias_v_prop <span class="op">=</span> <span class="fl">0.02</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"RCT"</span>  <span class="co"># or whatever design you want</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">indirectness_priors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  result_id <span class="op">=</span> <span class="va">example_data</span><span class="op">$</span><span class="va">result_id</span>,</span>
<span>  domain <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  j <span class="op">=</span> <span class="st">"moderate"</span>,</span>
<span>  ind_m_add <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  ind_v_add <span class="op">=</span> <span class="fl">0.03</span>,</span>
<span>  ind_m_prop <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  ind_v_prop <span class="op">=</span> <span class="fl">0.02</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="run-bias-adjustment">Run bias adjustment<a class="anchor" aria-label="anchor" href="#run-bias-adjustment"></a>
</h2>
<p>We use tri_prep_data() and tri_calculate_adjusted_estimates() to get
bias-adjusted effect sizes.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># this is where we combine the bias/indirectness priors with the study results and adjusts yi and vi to get new columns yi_adj and vi_adj for the adjusted estimate and varainces, respectively</span></span>
<span></span>
<span><span class="va">base_prepped</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tri_prep_data.html">tri_prep_data</a></span><span class="op">(</span><span class="va">bias_priors</span>, <span class="va">indirectness_priors</span><span class="op">)</span></span>
<span><span class="va">base_adjusted</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tri_calculate_adjusted_estimates.html">tri_calculate_adjusted_estimates</a></span><span class="op">(</span><span class="va">base_prepped</span><span class="op">)</span></span>
<span></span>
<span><span class="va">base_adjusted</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">result_id</span>, <span class="va">yi</span>, <span class="va">yi_adj</span>, <span class="va">vi</span>, <span class="va">vi_adj</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 5</span></span></span>
<span><span class="co">#&gt;   result_id    yi   yi_adj    vi vi_adj</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> S1        -<span style="color: #BB0000;">0.2</span>  -<span style="color: #BB0000;">0.300</span>   0.02  0.080<span style="text-decoration: underline;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> S2         0.25  0.079<span style="text-decoration: underline;">5</span>  0.03  0.084<span style="text-decoration: underline;">5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> S3        -<span style="color: #BB0000;">0.1</span>  -<span style="color: #BB0000;">0.216</span>   0.015 0.074<span style="text-decoration: underline;">9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> S4         0.15 -<span style="color: #BB0000;">0.004</span><span style="color: #BB0000; text-decoration: underline;">90</span> 0.025 0.080<span style="text-decoration: underline;">6</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="stricter-sensitivity-scenario">Stricter sensitivity scenario<a class="anchor" aria-label="anchor" href="#stricter-sensitivity-scenario"></a>
</h2>
<p>We now increase the additive and proportional bias priors to simulate
a more conservative scenario.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># represents a stricter assumption e.g if the bias was worse than originally thought. same process applied as before but with new priors</span></span>
<span></span>
<span><span class="va">sensitive_bias</span> <span class="op">&lt;-</span> <span class="va">bias_priors</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    bias_m_add <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>    bias_v_add <span class="op">=</span> <span class="fl">0.08</span>,</span>
<span>    bias_m_prop <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>    bias_v_prop <span class="op">=</span> <span class="fl">0.04</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">sensitive_prepped</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tri_prep_data.html">tri_prep_data</a></span><span class="op">(</span><span class="va">sensitive_bias</span>, <span class="va">indirectness_priors</span><span class="op">)</span></span>
<span><span class="va">sensitive_adjusted</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tri_calculate_adjusted_estimates.html">tri_calculate_adjusted_estimates</a></span><span class="op">(</span><span class="va">sensitive_prepped</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sensitive_adjusted</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">result_id</span>, <span class="va">yi</span>, <span class="va">yi_adj</span>, <span class="va">vi</span>, <span class="va">vi_adj</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 5</span></span></span>
<span><span class="co">#&gt;   result_id    yi   yi_adj    vi vi_adj</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> S1        -<span style="color: #BB0000;">0.2</span>  -<span style="color: #BB0000;">0.365</span>   0.02  0.097<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> S2         0.25 -<span style="color: #BB0000;">0.007</span><span style="color: #BB0000; text-decoration: underline;">36</span> 0.03  0.097<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> S3        -<span style="color: #BB0000;">0.1</span>  -<span style="color: #BB0000;">0.285</span>   0.015 0.091<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> S4         0.15 -<span style="color: #BB0000;">0.086</span><span style="color: #BB0000; text-decoration: underline;">8</span>  0.025 0.094<span style="text-decoration: underline;">2</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="compare-results">compare results<a class="anchor" aria-label="anchor" href="#compare-results"></a>
</h2>
<p>We plot the adjusted effect estimates under both scenarios.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># overlays the 2 scenarios to visually represent how the priors affect the estimated effect</span></span>
<span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="va">base_adjusted</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>scenario <span class="op">=</span> <span class="st">"Base"</span><span class="op">)</span>,</span>
<span>  <span class="va">sensitive_adjusted</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>scenario <span class="op">=</span> <span class="st">"Stricter Bias"</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>result_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">result_id</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"S"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  <span class="co"># or use your preferred order</span></span>
<span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">comparison</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">result_id</span>, x <span class="op">=</span> <span class="va">yi_adj</span>, color <span class="op">=</span> <span class="va">scenario</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="fl">0.4</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_errorbarh</span><span class="op">(</span></span>
<span>    <span class="fu">aes</span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">yi_adj</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">vi_adj</span><span class="op">)</span>, xmax <span class="op">=</span> <span class="va">yi_adj</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">vi_adj</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    height <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>    position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="fl">0.4</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Adjusted Estimates: Base vs. Stricter Bias Priors"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Bias-Adjusted Effect"</span>,   <span class="co"># now horizontal axis</span></span>
<span>    y <span class="op">=</span> <span class="st">"Study"</span>                   <span class="co"># now vertical axis</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: `geom_errorbarh()` was deprecated in ggplot2 4.0.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use the `orientation` argument of `geom_errorbar()` instead.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span>
<span><span class="co">#&gt; `height` was translated to `width`.</span></span></code></pre></div>
<p><img src="sensitivity-analysis_files/figure-html/compare-1.png" class="r-plt" width="700"></p>
</div>
<div class="section level2">
<h2 id="conclusion">conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>This vignette illustrates how small changes in prior assumptions can
impact adjusted effect estimates. While triangulate doesn’t yet include
a built-in sensitivity function, this process can be easily scripted for
exploring model robustness.</p>
<p>Note that the <code>echo = FALSE</code> parameter was added to the
code chunk to prevent printing of the R code that generated the
plot.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Luke McGuinness, Tassia Jones, Chin Yang Shapland.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
