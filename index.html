<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Useful functions for performing evidence triangulation • triangulate</title>
<script src="lightswitch.js"></script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Useful functions for performing evidence triangulation">
<meta name="description" content="What the package does (one paragraph).">
<meta property="og:description" content="What the package does (one paragraph).">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">triangulate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/absolute_direction.html">Absolute direction of bias/indirectness</a></li>
    <li><a class="dropdown-item" href="articles/additional-levels-of-bias-and-indirectness.html">Adding additional levels of bias and indirectness</a></li>
    <li><a class="dropdown-item" href="articles/beta-carotene-chd-example.html">Triangulation example: Beta-carotene and CHD</a></li>
    <li><a class="dropdown-item" href="articles/Creating-triangulation-datasets.html">Creating triangulation datasets</a></li>
    <li><a class="dropdown-item" href="articles/interactive-sensitivity.html">Interactive Sensitivity Analysis</a></li>
    <li><a class="dropdown-item" href="articles/sensitivity-analysis.html">Sensitivity Analyses in Triangulate</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mcguinlu/triangulate/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="triangulate">triangulate<a class="anchor" aria-label="anchor" href="#triangulate"></a>
</h1></div>
<!-- badges: start -->

<p>The goal of triangulate is to create a generalised version of the bias-adjusted meta-analysis approach originally proposed by Turner et al. </p>
<p>There are a number of steps to this process:</p>
<ol style="list-style-type: decimal">
<li>Define the causal question of interest</li>
<li>Identify relevant evidence sources and standardise effect directions</li>
<li>Specify an idealised version of each study</li>
<li>Assess the extent and direction of bias/indirectness in each result</li>
<li>Define modifying terms for bias and indirectness in each result</li>
<li>Calculate bias-/indirectness-adjusted results and perform meta-analysis</li>
</ol>
<p>This package deals with steps 5 and 6.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>To install either run</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">'triangulate'</span>, repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'https://mrcieu.r-universe.dev'</span>, <span class="st">'https://cloud.r-project.org'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"mcguinlu/triangulate"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="warning-warning-notes">
<span class="emoji" data-emoji="warning">⚠️</span> WARNING NOTES<a class="anchor" aria-label="anchor" href="#warning-warning-notes"></a>
</h2>
<hr>
<blockquote>
<p><em>WARNING #1:</em> This package is under development, and as such the API is subject to change at any point without warning.</p>
</blockquote>
<hr>
<blockquote>
<p><em>WARNING #2:</em> The approach described requires work in the preparation of data to work with the package. Please be sure to read the documentation and make use of helper functions to check whether your data is set-up right.</p>
</blockquote>
<hr>
<blockquote>
<p><em>WARNING #3:</em> The approach described requires careful choice of valid prior distributions of bias/indirectness.</p>
</blockquote>
<hr>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<div class="section level3">
<h3 id="datasets">Datasets<a class="anchor" aria-label="anchor" href="#datasets"></a>
</h3>
<p>The approach described</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mcguinlu.github.io/triangulate">triangulate</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># See column names of dat_bias</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat_bias</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "result_id" "study"     "type"      "yi"        "vi"        "d1j"      </span></span>
<span><span class="co">#&gt;  [7] "d1t"       "d1d"       "d2j"       "d2t"       "d2d"       "d3j"      </span></span>
<span><span class="co">#&gt; [13] "d3t"       "d3d"       "d4j"       "d4t"       "d4d"       "d5j"      </span></span>
<span><span class="co">#&gt; [19] "d5t"       "d5d"       "d6j"       "d6t"       "d6d"       "d7j"      </span></span>
<span><span class="co">#&gt; [25] "d7t"       "d7d"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat_bias</span><span class="op">)</span></span>
<span><span class="co">#&gt;   result_id   study type          yi         vi      d1j d1t</span></span>
<span><span class="co">#&gt; 1   13401-2 Study 1 NRSI -0.12783337 0.12506586     High Add</span></span>
<span><span class="co">#&gt; 2   14632-2 Study 2 NRSI -0.19845094 0.08680919 Moderate Add</span></span>
<span><span class="co">#&gt; 3   14658-2 Study 3 NRSI -0.18632958 0.03361240     High Add</span></span>
<span><span class="co">#&gt; 4   14665-6 Study 4 NRSI  0.19062036 0.05526578     High Add</span></span>
<span><span class="co">#&gt; 5   14720-1 Study 5 NRSI -0.56211892 0.05141924     High Add</span></span>
<span><span class="co">#&gt; 6   14761-1 Study 6 NRSI -0.09431068 0.06969822     High Add</span></span>
<span><span class="co">#&gt;                    d1d      d2j  d2t                d2d      d3j  d3t</span></span>
<span><span class="co">#&gt; 1   Favours comparator      Low None               None Moderate Prop</span></span>
<span><span class="co">#&gt; 2 Favours experimental Moderate  Add Favours comparator      Low None</span></span>
<span><span class="co">#&gt; 3   Favours comparator     High  Add Favours comparator      Low None</span></span>
<span><span class="co">#&gt; 4   Favours comparator Moderate  Add      Unpredictable      Low None</span></span>
<span><span class="co">#&gt; 5   Favours comparator      Low None               None      Low None</span></span>
<span><span class="co">#&gt; 6   Favours comparator Moderate  Add Favours comparator      Low None</span></span>
<span><span class="co">#&gt;             d3d d4j  d4t  d4d      d5j  d5t           d5d      d6j  d6t</span></span>
<span><span class="co">#&gt; 1 Unpredictable Low None None      Low None          None      Low None</span></span>
<span><span class="co">#&gt; 2          None Low None None      Low None          None Moderate  Add</span></span>
<span><span class="co">#&gt; 3          None Low None None      Low None          None Moderate  Add</span></span>
<span><span class="co">#&gt; 4          None Low None None      Low None          None      Low None</span></span>
<span><span class="co">#&gt; 5          None Low None None Moderate Prop Unpredictable      Low None</span></span>
<span><span class="co">#&gt; 6          None Low None None Moderate Prop Unpredictable      Low None</span></span>
<span><span class="co">#&gt;             d6d      d7j  d7t            d7d</span></span>
<span><span class="co">#&gt; 1          None Moderate Prop Away from null</span></span>
<span><span class="co">#&gt; 2 Unpredictable Moderate Prop Away from null</span></span>
<span><span class="co">#&gt; 3 Unpredictable Moderate Prop Away from null</span></span>
<span><span class="co">#&gt; 4          None Moderate Prop Away from null</span></span>
<span><span class="co">#&gt; 5          None Moderate Prop Away from null</span></span>
<span><span class="co">#&gt; 6          None Moderate Prop Away from null</span></span>
<span></span>
<span><span class="fu"><a href="reference/tri_dat_check.html">tri_dat_check</a></span><span class="op">(</span><span class="va">dat_bias</span><span class="op">)</span></span>
<span><span class="co">#&gt; tri_dat_check(): All expected columns are present (mode = 'minimal').</span></span></code></pre></div>
<p>For details on how to create these datasets, see the <a href="https://mcguinlu.github.io/triangulate/articles/Creating-triangulation-datasets.html">Creating triangulation datasets</a> vignette (under construction).</p>
<p>Once we load our data, helper functions will convert it to <em>long</em> format and convert to absolute directions of bias/indirectness.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat_bias</span> <span class="op">&lt;-</span> <span class="fu">triangulate</span><span class="fu">::</span><span class="va"><a href="reference/dat_bias.html">dat_bias</a></span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span></span>
<span><span class="co"># Convert to long format</span></span>
<span><span class="fu"><a href="reference/tri_to_long.html">tri_to_long</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/tri_absolute_direction.html">tri_absolute_direction</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/tri_append_bias.html">tri_append_bias</a></span><span class="op">(</span><span class="fu">triangulate</span><span class="fu">::</span><span class="va"><a href="reference/dat_bias_values.html">dat_bias_values</a></span><span class="op">)</span></span></code></pre></div>
<p>Then apply the same approach to the indirectness dataset:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat_ind</span> <span class="op">&lt;-</span> <span class="fu">triangulate</span><span class="fu">::</span><span class="va"><a href="reference/dat_ind.html">dat_ind</a></span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Convert to long format</span></span>
<span>  <span class="fu"><a href="reference/tri_to_long.html">tri_to_long</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/tri_absolute_direction.html">tri_absolute_direction</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/tri_append_indirect.html">tri_append_indirect</a></span><span class="op">(</span><span class="fu">triangulate</span><span class="fu">::</span><span class="va"><a href="reference/dat_ind_values.html">dat_ind_values</a></span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="add-prior-distributions-of-biasindirectness">Add prior distributions of bias/indirectness<a class="anchor" aria-label="anchor" href="#add-prior-distributions-of-biasindirectness"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat_bias_values</span></span>
<span><span class="co">#&gt;   domain        j bias_m_add bias_v_add bias_m_prop bias_v_prop</span></span>
<span><span class="co">#&gt; 1    all     high       0.18       0.10        0.06       0.032</span></span>
<span><span class="co">#&gt; 2    all moderate       0.09       0.05        0.03       0.016</span></span>
<span><span class="co">#&gt; 3    all      low       0.00       0.00        0.00       0.000</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="create-final-dataset-and-analyse">Create final dataset and analyse<a class="anchor" aria-label="anchor" href="#create-final-dataset-and-analyse"></a>
</h2>
<p>We now have two clean datasets, one for bias and one for indirectness, that we can use to</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat_final</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tri_prep_data.html">tri_prep_data</a></span><span class="op">(</span><span class="va">dat_bias</span>, <span class="va">dat_ind</span><span class="op">)</span></span></code></pre></div>
<p>At this point, we have an unadjusted (<em>yi</em>, <em>vi</em>) and adjusted (<em>yi_adj</em>, <em>vi_adj</em>) estimates for each result.</p>
<p>These estimates can then simply be passed to <code>metafor</code> for analysis</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">metafor</span><span class="fu">::</span><span class="fu"><a href="https://wviechtb.github.io/metafor/reference/rma.uni.html" class="external-link">rma</a></span><span class="op">(</span></span>
<span>  yi <span class="op">=</span> <span class="va">yi</span>,</span>
<span>  vi <span class="op">=</span> <span class="va">vi</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dat_final</span>,</span>
<span>  slab <span class="op">=</span> <span class="va">dat_final</span><span class="op">$</span><span class="va">study</span>,</span>
<span>  method <span class="op">=</span> <span class="st">'DL'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Pass model to forest plot function</span></span>
<span><span class="fu">metafor</span><span class="fu">::</span><span class="fu"><a href="https://wviechtb.github.io/metafor/reference/forest.html" class="external-link">forest</a></span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  atransf <span class="op">=</span> <span class="va">exp</span>,</span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-8-1.png" alt="Forest plot" width="100%"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">model_adj</span> <span class="op">&lt;-</span> <span class="fu">metafor</span><span class="fu">::</span><span class="fu"><a href="https://wviechtb.github.io/metafor/reference/rma.uni.html" class="external-link">rma</a></span><span class="op">(</span></span>
<span>  yi <span class="op">=</span> <span class="va">yi_adj</span>,</span>
<span>  vi <span class="op">=</span> <span class="va">vi_adj</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dat_final</span>,</span>
<span>  slab <span class="op">=</span> <span class="va">dat_final</span><span class="op">$</span><span class="va">study</span>,</span>
<span>  method <span class="op">=</span> <span class="st">'DL'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Pass model to forest plot function</span></span>
<span><span class="fu">metafor</span><span class="fu">::</span><span class="fu"><a href="https://wviechtb.github.io/metafor/reference/forest.html" class="external-link">forest</a></span><span class="op">(</span></span>
<span>  <span class="va">model_adj</span>,</span>
<span>  atransf <span class="op">=</span> <span class="va">exp</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-8-2.png" alt="Forest plot" width="100%"></p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/mcguinlu/triangulate/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/mcguinlu/triangulate/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing triangulate</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Luke McGuinness <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-8730-9761" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Tassia Jones <br><small class="roles"> Author </small>   </li>
<li>Chin Yang Shapland <br><small class="roles"> Author </small>   </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://github.com/mcguinlu/triangulate/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/mcguinlu/triangulate/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Luke McGuinness, Tassia Jones, Chin Yang Shapland.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
